#when you try to send the same message to two different people using different
#public keys but the same modulus

from Crypto.Util.number import GCD,inverse
import binascii
e1=1337
e2=123

c1=16199288639997400293239971439665265722075404234214001448343267976809393067148486552343612872547290728933144735022715454453785575835993530358066428609139173357314073232631755545239664809778926729760226374749177239209080245755957061909255340662330393681683137588426594373829097202338691198086868603835108664646445630788967125614356614526667958585935954280412303443642864076310431577627508858874299292252214748351920573691920262111723143355355159842149062925901221906958816754929442108604438208639375149625807261312852606953917071714283004117499755718499670221665081392890472584527099590131786318614848608423057340115028
c2=15806810257354140318402261178209571738627556059121337675843866880995687366066535152848473384846594471862723098492628050602714833411999061824479482179048902424948420325931571553032644701719668534399340422763749921568256316501730214793962266415443469662400007903688990159416494291614158535426947598494973289686700294128633872881402421614545817594952811204500665742253177655409038131891541002856663369918210895259490469602398910304152249388360997337964478648403136759421548425626845379897828268268330791726750625671673677025899444044244304593054180348892310173202680983606663945389783442850652763683697453954530430680695
n=19397258434358849141038015715273562336470514911126000143223875810419012043141732250287926164058461656682077937237222077365316586533766482632641741919441218653352296775106281262253205166663059421196339093501287878615629156292626951177492690467672760808893625803568277799003290136250915082071957215654589572563938642793317484717957745993023048911871794804044098731149197584062831340032416931272867067981831756264426678430611251248519041294827032671783399984469569992824089769779777222532160525759285319796530236143645851508186132371245546723443477778770458549081098643802073470045319971706024391544292287742680435969569

'''
for x in range(-1000,1000):   #used this to calculate a,b
	for y in range(-1000,1000):
		if e1*x+e2*y==GCD(e1,e2):
			print(x,y)'''

'''
23, -250
'''

'''
better way to find a,b
a = inverse(e1, e2)
b = (GCD(e1, e2) - (a * e1))//e2
assert((a * e1 + b * e2) == 1)
'''

a=23
b=-250

i=inverse(c2,n) # since b is negative

m=((c1**a)*(i**-b))%n

print(m)

M=binascii.unhexlify(hex(m)[2:-1])
print(M)
